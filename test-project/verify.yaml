# Root config with subprojects and cross-dependencies
verifications:
  - name: frontend
    path: ./packages/frontend

  - name: backend
    path: ./packages/backend

  - name: integration-test
    command: echo "Running integration tests after subprojects"
    depends_on: [frontend, backend]
    cache_paths:
      - "*.md"

  # No cache_paths - always runs (relies on command's own caching)
  - name: always-run
    command: echo "This check always runs"

  # Aggregate check - no command, status derived from dependencies
  - name: all-subprojects
    depends_on: [frontend, backend]

  # Example with metadata extraction
  - name: test-with-metrics
    command: |
      echo "Running tests..."
      echo "Tests: 127 passed, 3 failed"
      echo "Coverage: 85.5%"
      echo "Files: 42"
    cache_paths:
      - "*.md"
    metadata:
      passed: "Tests: (\\d+) passed"
      failed: "(\\d+) failed"
      coverage: "Coverage: ([\\d.]+)%"
      files: "Files: (\\d+)"

  # Always fails - for testing failure output
  - name: always-fails
    command: echo "This test always fails" && exit 1

  # Per-file mode test
  - name: flow-tests
    command: echo "Running flow test for $VERIFY_FILE" && cat "$VERIFY_FILE"
    cache_paths:
      - "flows/**/*.yaml"
    per_file: true
